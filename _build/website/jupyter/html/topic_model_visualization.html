<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">

		<title>Visualizing topic models &ndash; Documentation</title>

		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="author" content="">
		<meta name="keywords" content="">
		<meta name="description" content="">

		<link rel="stylesheet" href="/_static/css/base.css">

	</head>

	<body>

		<div class="wrapper">

			<header class="header">

				<div class="branding">

					<p class="site-title"><a href="/">Documentation</a></p>

					<p class="sr-only"><a href="#skip">Skip to content</a></p>

				</div>

				<div class="header-tools">


					<div class="header-badge" id="executability_status_badge"></div>


				</div>

			</header>

			<div class="main">

				<div class="content">

					<div id="skip"></div>

					<div class="document">

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a id='index-0'></a></p>
<p><a id='topic-model-visualization'></a></p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Visualizing-topic-models">Visualizing topic models<a class="anchor-link" href="#Visualizing-topic-models">&#182;</a></h1><blockquote><p><strong>Note</strong></p>
<p>Unlike R or Octave/Matlab, Python has no native graphing or
visualization library. The most widely used library for visualization is
<a href="http://matplotlib.org">matplotlib</a> and its functions mimic those found in
Octave/Matlab (see <a href="getting_started.html#getting-started-matplotlib">For those new to Matplotlib</a>).</p>
</blockquote>

</div>
</div>
</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualizing-topic-shares">Visualizing topic shares<a class="anchor-link" href="#Visualizing-topic-shares">&#182;</a></h2><p>When using topic models to explore text collections, we are typically interested
in examining texts in terms of their constituent topics (instead of word
frequencies).  Because the number of topics is so much smaller than the number
of unique vocabulary elements (say, 20 versus 20,000), a range of data
visualization methods become available. The visualization techniques discussed
below are not specific to topic models per se but rather fall into a more
general category for techniques for visualizing count data.</p>
<p>The first way of visualizing the topic proportions associated with documents in
a corpus uses a “stacked bar chart”.  This visualization tends to be used
when the number of topics is small. For example, a stacked
bar chart is found in a paper employing LDA <em>avant la lettre</em> on <a href="https://en.wikipedia.org/wiki/Allele">allele</a> frequency data
<a href="references.html#rosenberg-genetic-2002">[RPW+02]</a>. <sup><a href=#fnpritchard id=fnpritchard-link>[1]</a></sup></p>
<p><img src="_static/rosenberg-et-al-2002-figure.png" alt="Figure from Rosenberg et al. (2002), using methods described in Pritchard et al. (2000)" style="width:60%;height:60%"></p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stacked-bar-chart">Stacked bar chart<a class="anchor-link" href="#Stacked-bar-chart">&#182;</a></h3><p>The idea underlying the stacked bar chart is that each text has some proportion
of its words associated with each topic. Because the model assumes that every
word is associated with some topic, these proportions must add up to one. For
example, in a three topic model, text number 1 might have 50% of its words
associated with topic 1, 25% with topic 2, and 25% with topic 3. The stacked bar
chart represents each document as a bar broken into colored segments matching
the associated proportions of each topic. The stacked bar chart below expresses
the topic proportions found in the six novels in the <code>austen-brontë</code> corpus:</p>
<p><img src="_static/plot_doctopic_stacked_bar.png" alt="Topic shares in six novels" style="width:60%;height:60%"></p>
<p>If we look ahead to the <a href="#visualizing-topic-word">top 10 words associated with each topic</a>, we find that topics 0 and 1 are associated with words
we anticipate finding in Austen (‘emma’, ‘elizabeth’, ‘darcy’, ‘sister’). Topic
4 is connected with <em>Jane Eyre</em> (‘rochester’, ‘house’).</p>
<p>This method of visualization works well when there are a small number of topics.
With more than a handful of topics, the proportion associated with
each topic tends to be difficult to distinguish. This is a limitation of the
stacked bar chart. On the other hand, the visualization clearly communicates the
idea that a document is made up of topic proportions that, taken together,
account for all the words in a document.</p>
<p>To reproduce the stacked bar chart shown above we first need to model the
<code>austen-brontë</code> corpus using a five-topic topic model. We will use the
procedure described in <a href="topic_model_mallet.html#topic-model-mallet">Topic modeling with MALLET</a>. First
we run MALLET using default parameters. As we will be analyzing more precisely
the association of words with topics, we will specify that the counts of
word-topic assignments be saved with the command-line option <code>--word-topic counts
/tmp/word-topic.txt</code>.</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span>mallet-2.0.7/bin/mallet import-dir --input data/austen-brontë-split/ --output /tmp/topic-input.mallet --keep-sequence --remove-stopwords
mallet-2.0.7/bin/mallet train-topics --input /tmp/topic-input.mallet --num-topics <span class="m">5</span> --output-doc-topics /tmp/doc-topics.txt --output-topic-keys /tmp/topic-keys.txt --word-topic-counts-file /tmp/word-topic.txt
</pre></div>

</div>
</div>
</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We then gather the output into a document-topic matrix of topic shares, stored
in the variable <code>doctopic</code>. The names of the novels are stored in the variable
<code>docnames</code>.</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">docnames</span>
<span class="n">doctopic</span><span class="o">.</span><span class="n">shape</span>
<span class="n">doctopic</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-f71495d3fa53&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>docnames
<span class="ansi-green-intense-fg ansi-bold">      2</span> doctopic<span class="ansi-blue-fg">.</span>shape
<span class="ansi-green-intense-fg ansi-bold">      3</span> doctopic

<span class="ansi-red-fg">NameError</span>: name &#39;docnames&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To make the stacked bar chart we layer individual bar charts on top of each
other. Recall that a single (unstacked) bar chart can be created in matplotlib
with the following code:</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">N</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">doctopic</span><span class="o">.</span><span class="n">shape</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># points on the x-axis</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">doctopic</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">docnames</span><span class="p">)</span>  <span class="c1"># put labels in the center</span>

<span class="nd">@savefig</span> <span class="n">plot_example_bar</span><span class="o">.</span><span class="n">png</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="ow">in</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Share of Topic #0&#39;</span><span class="p">)</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;ipython-input-2-4c3185be5c4f&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">10</span>
<span class="ansi-red-fg">    @savefig plot_example_bar.png width=7in</span>
                            ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax
</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>Note</strong></p>
<p>The <a href="http://matplotlib.org/examples/index.html">matplotlib examples page</a> describes
how to produce various types of graphs using matplotlib.</p>
</blockquote>
<p>To layer the bar charts, we plot each bar chart one by one, adjusting the
starting point (<code>bottom</code> is the parameter) so that the charts do not overlap.</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># See: http://matplotlib.org/examples/pylab_examples/bar_stacked.html</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">N</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">doctopic</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># N documents, K topics</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># the x-axis locations for the novels</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># the width of the bars</span>
<span class="n">plots</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">height_cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># first plot</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">doctopic</span><span class="p">[:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">doctopic</span><span class="p">[:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">width</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">height_cumulative</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">height_cumulative</span> <span class="o">+=</span> <span class="n">doctopic</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># proportions sum to 1, so the height of the stacked bars is 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Topics&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Topics in novels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="o">+</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">docnames</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">topic_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Topic #</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">)]</span>
<span class="c1"># see http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.legend for details</span>
<span class="c1"># on making a legend in matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">],</span> <span class="n">topic_labels</span><span class="p">)</span>

<span class="nd">@savefig</span> <span class="n">plot_doctopic_stacked_bar</span><span class="o">.</span><span class="n">png</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="ow">in</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;ipython-input-3-9a45d66d2027&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">30</span>
<span class="ansi-red-fg">    @savefig plot_doctopic_stacked_bar.png width=7in</span>
                                     ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax
</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Heatmap">Heatmap<a class="anchor-link" href="#Heatmap">&#182;</a></h3><p>Another useful visualization of topic shares is the heatmap. The matplotlib
function we need is <code>pcolor</code> (“psuedocolor plot”).</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Ref: http://nbviewer.ipython.org/5427209</span>
<span class="c1"># Ref: http://code.activestate.com/recipes/578175-hierarchical-clustering-heatmap-python/</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">doctopic</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>

<span class="c1"># put the major ticks at the middle of each cell</span>
<span class="c1"># the trailing semicolon &#39;;&#39; suppresses output</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">doctopic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">docnames</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">doctopic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">topic_labels</span><span class="p">);</span>

<span class="c1"># flip the y-axis so the texts are in the order we anticipate (Austen first, then Brontë)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="c1"># rotate the ticks on the x-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># add a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># fixes margins</span>

<span class="nd">@savefig</span> <span class="n">plot_doctopic_heatmap</span><span class="o">.</span><span class="n">png</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="ow">in</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;ipython-input-4-f9055a12a2ba&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">22</span>
<span class="ansi-red-fg">    @savefig plot_doctopic_heatmap.png width=7in</span>
                                 ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax
</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, we see that topics 0 and 1 are strongly associated with the Austen
novels, whereas words assigned to topic 3 predominate in novels written by
Brontë.</p>
<p><a id='visualizing-topic-word'></a></p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualizing-topic-word-associations">Visualizing topic-word associations<a class="anchor-link" href="#Visualizing-topic-word-associations">&#182;</a></h2><blockquote><p><strong>Note</strong></p>
<p>For the following visualizations we will need the counts of
word-to-topic assignments. These are stored in a file specified by the
MALLET option <code>--word-topic-counts-file</code>. The following assumes that the
file containing the counts is available at <code>/tmp/word-topic.txt</code>.</p>
</blockquote>

</div>
</div>
</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Table">Table<a class="anchor-link" href="#Table">&#182;</a></h3><p>We have already seen a simple way of “visualizing” the associations between
topics and words: lists of the top words associated with each topic are often
all that is needed when the corpus is large and the inferred topics make sense
in light of prior knowledge of the corpus.</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/tmp/topic-keys.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">input</span><span class="p">:</span>
    <span class="n">topic_keys_lines</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">topic_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">topic_keys_lines</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># tab-separated</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>  <span class="c1"># remove the trailing &#39;\n&#39;</span>
    <span class="n">topic_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">topic_words</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Topic </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">topic_words</span><span class="p">[</span><span class="n">t</span><span class="p">][:</span><span class="mi">15</span><span class="p">])))</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-5-3110dccb28a9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">with</span> open<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;/tmp/topic-keys.txt&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> input<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>     topic_keys_lines <span class="ansi-blue-fg">=</span> input<span class="ansi-blue-fg">.</span>readlines<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> topic_words <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-green-fg">for</span> line <span class="ansi-green-fg">in</span> topic_keys_lines<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>     _<span class="ansi-blue-fg">,</span> _<span class="ansi-blue-fg">,</span> words <span class="ansi-blue-fg">=</span> line<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;\t&#39;</span><span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># tab-separated</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/tmp/topic-keys.txt&#39;</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sizing-words-according-to-strength-of-association-with-a-topic">Sizing words according to strength of association with a topic<a class="anchor-link" href="#Sizing-words-according-to-strength-of-association-with-a-topic">&#182;</a></h3><p>Each topic is a distribution over the vocabulary of words found in the corpus.
The top words (saved via the <code>--topic-keys</code> option) are those words most
likely to be found in each topic. Displaying the top words does not, however,
convey any information about the probability of finding a top word assigned to
a specific topic. This is often critical information.  (For those in the process
of learning about discrete probability distributions, we may think of this
probability as the ‘strength of association’ between a word and a topic.) For
example, the top five words of topic 1 may be much more strongly associated with
the topic than the top five words of topic 2. In some cases this can be extreme,
the tenth top word for topic 1 may hardly ever be associated with topic 1,
whereas the tenth top word for topic 2 may be assigned frequently to topic 2.
Moreover, if most of the words in the vocabulary are equally associated with
a topic then identifying the “top 10 words” is misleading.</p>
<p>To estimate the strength of association between a given word and a given topic
we need the information saved in the file specified by the MALLET option
<code>--word-topic-counts-file</code>, here <code>/tmp/word-topic.txt</code>. The first few lines
of this file look like this:</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">0</span> <span class="n">delightful</span> <span class="mi">0</span><span class="p">:</span><span class="mi">86</span>
<span class="mi">1</span> <span class="n">thing</span> <span class="mi">0</span><span class="p">:</span><span class="mi">801</span> <span class="mi">3</span><span class="p">:</span><span class="mi">1</span>
<span class="mi">2</span> <span class="n">daughter</span> <span class="mi">1</span><span class="p">:</span><span class="mi">278</span>
<span class="mi">3</span> <span class="n">married</span> <span class="mi">1</span><span class="p">:</span><span class="mi">251</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;ipython-input-6-7d8fd02f0d12&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">1</span>
<span class="ansi-red-fg">    0 delightful 0:86</span>
               ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax
</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first line indicates that the word ‘delightful’ is assigned to topic 0 86
times. The second line tells us that the word ‘thing’ is associated with topic
0 801 times and to topic 3 once.</p>
<p>In order to make systematic use of this information we need to parse this file
into a matrix of counts. We do this much in the same manner as we parsed
<code>doc-topics.txt</code> into a matrix of document-topic shares. The following
procedure should be familiar by now:</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">num_topics</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">mallet_vocab</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">word_topic_counts</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/word-topic.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="o">*</span><span class="n">topic_count_pairs</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="c1"># turn topic_count_pairs from a string like &quot;0:30 1:20&quot; to a sequence of pairs [(0, 30), (1, 20)]</span>
        <span class="n">topic_count_pairs</span> <span class="o">=</span> <span class="p">[</span><span class="n">pair</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">topic_count_pairs</span><span class="p">]</span>
        <span class="n">mallet_vocab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="c1"># allocate an &#39;empty&#39; array of zeros to store the counts for this word</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_topics</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">topic</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">topic_count_pairs</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">topic</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="n">word_topic_counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
<span class="n">word_topic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">word_topic_counts</span><span class="p">)</span>

<span class="n">word_topic</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-7-c82f57adaee3&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span> word_topic_counts <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> 
<span class="ansi-green-fg">----&gt; 9</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">with</span> open<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;/tmp/word-topic.txt&#34;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> f<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span>     <span class="ansi-green-fg">for</span> line <span class="ansi-green-fg">in</span> f<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>         _<span class="ansi-blue-fg">,</span> word<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>topic_count_pairs <span class="ansi-blue-fg">=</span> line<span class="ansi-blue-fg">.</span>rstrip<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39; &#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/tmp/word-topic.txt&#39;</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since topics will be assigned differing numbers of words we need to normalize
this matrix of counts in much the same way as we did for the matrix of
document-term counts (see <a href="working_with_text.html#working-with-text">Working with text</a>). For example, while the word
“delightful” may be assigned to topic 0 86 times, there may be many other words
that are also assigned to topic 0 a similar or greater number of times. In order
to measure the strength of association between “delightful” and topic 0 we need
to know how likely it is to be associated with topic 0 relative to all other
words.  We do this by calculating the proportion of words assigned to topic
0 that are the word “delightful”. Doing this for each word and each topic in
turn will turn our matrix of word-topic counts into a matrix of word-topic
proportions. For example, a value of 0.5 in the matrix at row 5 and column
0 indicates that the specified word type (<code>mallet_vocab[5]</code>) accounts for 50
percent of all words assigned to topic 0.</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># np.sum(word_topic, axis=0) sums across rows, so it yields totals of words assigned to topics</span>
<span class="n">word_topic</span> <span class="o">=</span> <span class="n">word_topic</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">word_topic</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-8-b2525cdbe7c2&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># np.sum(word_topic, axis=0) sums across rows, so it yields totals of words assigned to topics</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>word_topic <span class="ansi-blue-fg">=</span> word_topic <span class="ansi-blue-fg">/</span> np<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span>word_topic<span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;word_topic&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can assemble a list of each topic’s top words along with a value that
captures the strength of association with that topic.</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_top_words</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mallet_vocab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mallet_vocab</span><span class="p">)</span>  <span class="c1"># convert vocab from a list to an array so we can use NumPy operations on it</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_topics</span><span class="p">):</span>
    <span class="n">top_words_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">word_topic</span><span class="p">[:,</span><span class="n">t</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># descending order</span>
    <span class="n">top_words_idx</span> <span class="o">=</span> <span class="n">top_words_idx</span><span class="p">[:</span><span class="n">num_top_words</span><span class="p">]</span>
    <span class="n">top_words</span> <span class="o">=</span> <span class="n">mallet_vocab</span><span class="p">[</span><span class="n">top_words_idx</span><span class="p">]</span>
    <span class="n">top_words_shares</span> <span class="o">=</span> <span class="n">word_topic</span><span class="p">[</span><span class="n">top_words_idx</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Topic #</span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">share</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">top_words</span><span class="p">,</span> <span class="n">top_words_shares</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">share</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">word</span><span class="p">))</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-777ad39100e2&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> mallet_vocab <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>mallet_vocab<span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># convert vocab from a list to an array so we can use NumPy operations on it</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-green-fg">for</span> t <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>num_topics<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg">     </span>top_words_idx <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>argsort<span class="ansi-blue-fg">(</span>word_topic<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">,</span>t<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>  <span class="ansi-red-fg"># descending order</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>     top_words_idx <span class="ansi-blue-fg">=</span> top_words_idx<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span>num_top_words<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>     top_words <span class="ansi-blue-fg">=</span> mallet_vocab<span class="ansi-blue-fg">[</span>top_words_idx<span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;word_topic&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One way to visualize this information is to size each word in proportion to its
share of words associated with each topic:</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">num_top_words</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">fontsize_base</span> <span class="o">=</span> <span class="mi">70</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">word_topic</span><span class="p">)</span> <span class="c1"># font size for word with largest share in corpus</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_topics</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_topics</span><span class="p">,</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># plot numbering starts with 1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_top_words</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># stretch the y-axis to accommodate the words</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>  <span class="c1"># remove x-axis markings (&#39;ticks&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span> <span class="c1"># remove y-axis markings (&#39;ticks&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Topic #</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">top_words_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">word_topic</span><span class="p">[:,</span><span class="n">t</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># descending order</span>
    <span class="n">top_words_idx</span> <span class="o">=</span> <span class="n">top_words_idx</span><span class="p">[:</span><span class="n">num_top_words</span><span class="p">]</span>
    <span class="n">top_words</span> <span class="o">=</span> <span class="n">mallet_vocab</span><span class="p">[</span><span class="n">top_words_idx</span><span class="p">]</span>
    <span class="n">top_words_shares</span> <span class="o">=</span> <span class="n">word_topic</span><span class="p">[</span><span class="n">top_words_idx</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">share</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">top_words</span><span class="p">,</span> <span class="n">top_words_shares</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">num_top_words</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_base</span><span class="o">*</span><span class="n">share</span><span class="p">)</span>

<span class="nd">@savefig</span> <span class="n">plot_word_topic</span><span class="o">.</span><span class="n">png</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="ow">in</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;ipython-input-10-e44c4150f9eb&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">17</span>
<span class="ansi-red-fg">    @savefig plot_word_topic.png width=7in</span>
                           ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax
</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that topic 3 is much more concentrated on the words shown above
whereas topic 0 is much more diffuse (or uniform). Another way to appreciate
this is to calculate the number of word <em>types</em> associated with each topic:</p>

</div>
</div>
</div>

<div class="{} cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
	<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">word_topic</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

	</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

	<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-11-038d52f68402&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>np<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span>word_topic <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;word_topic&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>

<div class="{} cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This shows us that a greater diversity of vocabulary items are associated with
topic 0 (likely many of the French words that appear only in Brontë’s <em>The
Professor</em>) than with topic 3.</p>
<p><p><a id=fnpritchard href=#fnpritchard-link><strong>[1]</strong></a> The topic model now familiar as LDA was independently
discovered and published in 2000 by Pritchard et al.
<a href="references.html#pritchard-inference-2000">[PSD00]</a>.</p>

</div>
</div>
</div>
 




					</div>

				</div>

			</div>

			<footer class="footer">

				<p>&copy; Copyright <YEAR>, Built using the minimal jupinx template.</p>

			</footer>

		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		<script src="/_static/js/base.js"></script>

	</body>
</html>